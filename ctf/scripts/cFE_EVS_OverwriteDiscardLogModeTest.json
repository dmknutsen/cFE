{
    "test_name": "cFE_EVS_OverwriteDiscardLogModeTest",
    "test_number": "1175_1178",
    "test_setup": "No setup",
    "description": "The purpose of this test is to verify the EVS log requirements for the Event Service (EVS) function of the Core Flight Executive (cFE) software.  The test consists of inducing known events into the Event Log until the log becomes full.  During the test, the Event Log will be filled twice to test the functionality of both the Overwrite and Discard modes.  After filling the Event Log in each mode, the Local Event Log Full flag, Local Event Log Overflow Counter, Event Logging Mode flag, and Event Format flag will be examined for proper value(s).  Further, the contents of the Event Log will be dumped to verify the successful operation of each mode.",
    "owner": "Dan Knutsen",
    "ctf_options": {},
    "environment": {},
    "requirements": {
        "cEVS3014 ": "Full",
        "cEVS3108.1 ": "Full",
        " cEVS3108.2 ": "Full",
        "cEVS3108.3 ": "Full"
    },
    "telemetry_watch_list": {
        "CFE_ES_HK_TLM_MID": [
            "Payload.CommandCounter"
        ],
        "CFE_EVS_HK_TLM_MID": [
            "Payload.CommandErrorCounter",
            "Payload.MessageFormatMode",
            1,
            "Payload.MessageTruncCounter",
            "Payload.LogFullFlag",
            "Payload.LogOverflowCounter",
            "Payload.LogMode",
            "Payload.CommandCounter",
            2
        ]
    },
    "command_watch_list": {
        "CFE_EVS_CMD_MID": [
            "CFE_EVS_SET_FILTER_CC",
            "CFE_EVS_CLEAR_LOG_CC",
            "CFE_EVS_RESET_COUNTERS_CC",
            "CFE_EVS_SET_LOG_MODE_CC",
            "CFE_EVS_WRITE_LOG_DATA_FILE_CC",
            "CFE_EVS_NOOP_CC"
        ],
        "CFE_ES_CMD_MID": [
            "CFE_ES_NOOP_CC"
        ]
    },
    "functions": {},
    "tests": [
        {
            "case_number": "Initialize Test - start cFS, Enable Output, and clear log + zero counters",
            "description": "No description",
            "commands": [
                {
                    "command": "StartCfs",
                    "data": {
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "EnableCfsOutput",
                    "data": {
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "TO_DO",
                    "data": {
                        "Comment": "Start Sending Temporary Filter Commands because of cFE issue_564",
                        "ReturnErrorFlag": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_SET_FILTER_CC",
                        "args": {
                            "Payload": {
                                "AppName": "CFE_SB",
                                "EventID": 17,
                                "Mask": 65535
                            }
                        },
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_SET_FILTER_CC",
                        "args": {
                            "Payload": {
                                "AppName": "SCH",
                                "EventID": 17,
                                "Mask": 65535
                            }
                        },
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_SET_FILTER_CC",
                        "args": {
                            "Payload": {
                                "AppName": "SCH",
                                "EventID": 18,
                                "Mask": 65535
                            }
                        },
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "TO_DO",
                    "data": {
                        "Comment": "End of Temporary Filter Commands",
                        "ReturnErrorFlag": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_CLEAR_LOG_CC",
                        "args": [],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_RESET_COUNTERS_CC",
                        "args": [],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_ES_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.CommandCounter",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.CommandErrorCounter",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.MessageFormatMode",
                                "value": [
                                    1
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.MessageTruncCounter",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogFullFlag",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogOverflowCounter",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogMode",
                                "value": [
                                    1
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                }
            ]
        },
        {
            "case_number": "Verify Overwrite Req.",
            "description": "No description",
            "commands": [
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_SET_LOG_MODE_CC",
                        "args": {
                            "Payload": {
                                "LogMode": 0,
                                "Spare": 0
                            }
                        },
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogMode",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendMultCfsCommands",
                    "data": {
                        "mid": "CFE_ES_CMD_MID",
                        "cc": "CFE_ES_NOOP_CC",
                        "args": [],
                        "name": "",
                        "mult": 10
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_ES_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.CommandCounter",
                                "value": [
                                    10
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "TO_DO",
                    "data": {
                        "Comment": "Messagee send counter equals 8 here...was expecting 20 - investigate",
                        "ReturnErrorFlag": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogFullFlag",
                                "value": [
                                    1
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "TO_DO",
                    "data": {
                        "Comment": "Removed check for log overflow counter - sometimes would be 0 other times 1...investigate",
                        "ReturnErrorFlag": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_WRITE_LOG_DATA_FILE_CC",
                        "args": {
                            "Payload": {
                                "LogFilename": "/cf/EventLogTest"
                            }
                        },
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "InterpretEventLog",
                    "data": {
                        "InputFile": "/cf/EventLogTest",
                        "OutputFile": "/cf/InterpretedEventLogTest.txt"
                    },
                    "wait": 1
                },
                {
                    "command": "ParseTxtFile",
                    "data": {
                        "FileName": "/cf/InterpretedEventLogTest.txt",
                        "SearchString": "CFE_EVS               000  INFORMATION - No-op command. cFE Version",
                        "SearchNonExistFlag": 1
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_NOOP_CC",
                        "args": [],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.CommandCounter",
                                "value": [
                                    2
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_WRITE_LOG_DATA_FILE_CC",
                        "args": {
                            "Payload": {
                                "LogFilename": "/cf/EventLogTest"
                            }
                        },
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "InterpretEventLog",
                    "data": {
                        "InputFile": "/cf/EventLogTest",
                        "OutputFile": "/cf/InterpretedEventLogTest.txt"
                    },
                    "wait": 1
                },
                {
                    "command": "ParseTxtFile",
                    "data": {
                        "FileName": "/cf/InterpretedEventLogTest.txt",
                        "SearchString": "CFE_EVS               000  INFORMATION - No-op command. cFE Version",
                        "SearchNonExistFlag": ""
                    },
                    "wait": 1
                }
            ]
        },
        {
            "case_number": "Reset Test - Clear logs/counters + verify cleared successfully",
            "description": "No description",
            "commands": [
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_CLEAR_LOG_CC",
                        "args": [],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_RESET_COUNTERS_CC",
                        "args": [],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.CommandCounter",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.CommandErrorCounter",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogFullFlag",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogOverflowCounter",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogMode",
                                "value": [
                                    "0"
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                }
            ]
        },
        {
            "case_number": "Verify Discard Req.",
            "description": "No description",
            "commands": [
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_SET_LOG_MODE_CC",
                        "args": {
                            "Payload": {
                                "LogMode": 1,
                                "Spare": 0
                            }
                        },
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogMode",
                                "value": [
                                    1
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendMultCfsCommands",
                    "data": {
                        "mid": "CFE_ES_CMD_MID",
                        "cc": "CFE_ES_NOOP_CC",
                        "args": [],
                        "name": "",
                        "mult": 10
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.LogFullFlag",
                                "value": [
                                    1
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_NOOP_CC",
                        "args": [],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "CheckTlmValue",
                    "data": {
                        "mid": "CFE_EVS_HK_TLM_MID",
                        "args": [
                            {
                                "variable": "Payload.CommandCounter",
                                "value": [
                                    2
                                ],
                                "compare": "=="
                            }
                        ],
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "SendCfsCommand",
                    "data": {
                        "mid": "CFE_EVS_CMD_MID",
                        "cc": "CFE_EVS_WRITE_LOG_DATA_FILE_CC",
                        "args": {
                            "Payload": {
                                "LogFilename": "/cf/EventLogTest"
                            }
                        },
                        "name": ""
                    },
                    "wait": 1
                },
                {
                    "command": "InterpretEventLog",
                    "data": {
                        "InputFile": "/cf/EventLogTest",
                        "OutputFile": "/cf/InterpretedEventLogTest.txt"
                    },
                    "wait": 1
                },
                {
                    "command": "ParseTxtFile",
                    "data": {
                        "FileName": "/cf/InterpretedEventLogTest.txt",
                        "SearchString": "CFE_EVS               000  INFORMATION - No-op command. cFE Version",
                        "SearchNonExistFlag": 1
                    },
                    "wait": 1
                },
                {
                    "command": "ShutdownCfs",
                    "data": {
                        "name": ""
                    },
                    "wait": 1
                }
            ]
        }
    ]
}